<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8>
		<title>My first Three.js app</title>
		<style>
			body { margin: 0; background-color: black }
			canvas { width: 100%; height: 100% }
		</style>


		<script id="vertexShader" type="x-shader/x-vertex">
			void main()	{
				gl_Position = vec4( position, 1.0 );
			}
		</script>

		<script id="fragmentShader" type="x-shader/x-fragment">


			#define TWO_PI 6.283185307179586
			#define PI 3.141592653589793

			uniform float time;
			uniform vec2 mouse;
			uniform vec2 resolution;

			float scale = 4.0;

			void main() {

				vec2 pos = ( gl_FragCoord.xy / resolution.xy ) - 0.5;
				pos *= vec2(2.0, resolution.y * 2.0/ resolution.x) * scale;

				vec2 mouseP = mouse - .5;
				mouseP *= vec2(2.0, resolution.y * -2.0/ resolution.x) * scale;
				
				vec2 center = vec2(0.,0.);

				float cp = 1.0 - step(0.05, distance(pos , mouseP));
				float mp = 1.0 - step(0.05, distance(pos , center));


				vec2 dcenter = mouseP;

				//polar coordinates
				
				float theta = atan(dcenter.y, dcenter.x ) + PI;
				float ntheta = theta /TWO_PI; 
				float r = distance(pos, center);

				vec2 pos2 = pos - dcenter;

				float theta2 = atan(pos2.y , pos2.x) + PI;
				float ntheta2 = theta2 /TWO_PI; 
				float r2 = length(pos2); // not sure we need this 


				//bit of additive synthesis for the edge
				float edge = sin(atan(pos2.y, pos2.x) * 5.) * 0.1 + 1.0;

		
				float radius = 1.0 - length(dcenter) * cos(theta2 - theta);
				

				float slice = fract(ntheta2 * 12.0);


				//make the strips
				float strips = fract( r2 /radius * edge2 * 5. );

				//make the outline
				float outer = smoothstep(0.0,0.05,1.0 - (r2 /radius * edge));

				vec3 markers = vec3(0., cp,  0.) + vec3(mp,0., 0.);

				gl_FragColor = vec4( vec3(strips * slice * outer) + markers,1.0 );

	

			} 


		</script>

	</head>
	<body>
		<script src="three.min.js"></script>
		<script type="text/javascript" src="main.js"></script>
	</body>
</html>